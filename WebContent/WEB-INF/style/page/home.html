<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
   
<meta name="renderer" content="webkit">
<meta name="keywords" content=""/>
<meta name="description" content=""/>
<title>首页</title>
<link href="res/css/sip_new_home.css?v=2.1" rel="stylesheet" type="text/css">
<link href="res/css/bootstrap.min.css?v=2.1" rel="stylesheet" type="text/css" />
<link href="res/css/style.css?v=2.2" rel="stylesheet" type="text/css" />
<link href="res/css/font-awesome.min.css?v=2.1" rel="stylesheet"/>


<link href="new/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
<link href="new/css/font-awesome.min.css" rel="stylesheet"/>
<link rel="stylesheet" href="new/css/style.css" />
<link rel="stylesheet" href="new/css/iconfont.css" />
<link rel="stylesheet" href="new/css/css.css"/>

<script src="res/js/jquery.js?v=2.1" type="text/javascript"></script>
<!--<script src="echarts.min.js?v=2.1"></script>-->
<script src="new/js/echarts.min.js" type="text/javascript"></script>
<script src="new/js/showecahrts.js" type="text/javascript"></script>
<script src="res/js/bootstrap.min.js?v=2.1" type="text/javascript"></script>
  
      <script>
<script type="text/javascript">
$(function () {
	var navLi=$(".menu .nav li");
	navLi.mouseover(function () {
		$(this).find("a").addClass("current");
		$(this).find('.trig').show();
		$(this).find(".box").stop().slideDown(200);
	});
	navLi.mouseleave(function(){
		$(this).find("a").removeClass("current");
		$(this).find('.trig').hide();
		$(this).find(".box").stop().slideUp(200);
	});
})
</script>

</head>
<body>	
	<div class="main" style="width: 99%;height: 99%;overflow: auto;">
		<!--<div class="col-xs-10 pad-l0">-->
			<div style="height:33%">
				<div class="zhxx">
					<div class="title">
						<h1><i class="iconfont">&#xe638</i> 综合信息</h1>
						<!--<div class="more">
							<a href="###">MORE>></a>
						</div>-->
						<div class="more2">
							<h1>安全生产天数</h1>
							<h2 class="purple"  id="aqsch2">
								<ylt.for dataId="1534479850565">
									$value
								</ylt.for>
							</h2>
						</div>
					</div>
					<ul>
						<li class="dbsx">
							<h1>月计划发电量</h1>
							<ylt.for dataId="1548146813403">
							<h2 class="blue" id="dbsxh2">1机组&nbsp;&nbsp;$value<span>万kW·h</span></br>2机组&nbsp;&nbsp;$value<span>万kW·h</h2>
							</ylt.for>
						</li>
						<li class="ybsl">
							<h1>月实际发电量</h1>
							<h2 class="green" id="ybslh2">1机组&nbsp;&nbsp;<font id="id_yfdl1"></font> <span>万kW·h</span></br>2机组&nbsp;&nbsp;<font id="id_yfdl2"></font> <span>万kW·h</span></h2>
						</li>
						<li class="jhfd">
							<h1>年计划发电量</h1>
							<ylt.for dataId="1548147298286">
								<h2 class="orange" id="jhfdh2">1机组&nbsp;&nbsp;$value<span>万kW·h</span></br>2机组&nbsp;&nbsp;$value<span>万kW·h</span></h2>
							</ylt.for>
						</li>
						<li class="sjfd">
							<h1>年实际发电量</h1>
							<h2 class="red" id="sjfdh2">1机组&nbsp;&nbsp;<font id="id_nfdl1"></font> <span>万kW·h</span></br>2机组&nbsp;&nbsp;<font id="id_nfdl2"></font> <span>万kW·h</span></h2>
						</li>
						<!--<li class="aqsc">
							<h1>安全生产天数</h1>
							<h2 class="purple"  id="aqsch2">
								<ylt.for dataId="1534479850565">
									$value
								</ylt.for>
							</h2>
						</li>-->
					</ul>
				</div>
				<div class="hyxx">
					<div class="title">
						<h1><i class="iconfont">&#xe638</i> 生产例会</h1>
						<div class="more">
							<a href="###" onclick="morehy()">MORE>></a>
						</div>
					</div>
					<ul id="hyxxul">
						<ylt.for dataId="1548067419396">
						<li><a href="###" onclick="hy('$value','$value');"
                                    style="text-align: left;"><p>$value $value</p><span>$value</span></a></li>
						</ylt.for>	
					</ul>
					<!--<ul>
						<li><a href="###"><p>榆能榆神热电有限公司</p><span>2018.12.23</span></a></li>
						<li><a href="###"><p>榆能榆神热电有限公司</p><span>2018.12.23</span></a></li>
						<li><a href="###"><p>榆能榆神热电有限公司</p><span>2018.12.23</span></a></li>
						<li><a href="###"><p>榆能榆神热电有限公司</p><span>2018.12.23</span></a></li>
					</ul>-->
				</div>
			</div>
			
			<div class="clearfix"></div>
				
			<div class="middle" style="height:33%">
				<div class="dbrw">
					<div class="title">
						<h1><i class="iconfont">&#xe638</i> 待办任务</h1>
						<div class="more">
							<a href="###" onclick="modal_todo_show()">MORE>></a>
						</div>
					</div>
					<ul id='short_todo_list'></ul>	
				</div>
				<div class="ytj">
					<div class="title">
						<h1><i class="iconfont">&#xe638</i> 当月缺陷统计</h1>
						<!--<div class="more">
							<a href="###">MORE>></a>
						</div>-->
					</div>
					
					<div class="charts" style="width: 100%;height:90%;float: top; " id="piechartYqxtj">
						<script>
							var title = new Array();
							var perNum = new Array();
							<ylt.for dataId="1547873877843">
								title.push('$value');
								perNum.push('$value');
							</ylt.for>
							myfun(title,perNum);
						<!--myfun();-->
						</script>
						
						<!--<img src="new/images/charts1.png" class="center-block img-responsive">-->
					</div>
					
				</div>
				<div class="zbqk">
					<div class="title">
						<h1><i class="iconfont">&#xe638</i> 值班情况</h1>
						<!--<div class="more">
							<a href="###">MORE>></a>
						</div>-->
					</div>
					<ul>
						<li>
							<p>当值班次</p>
							<h1 class="blue" id="NO_DBBC"></h1>
						</li>
						<li>
							<p>交值班次</p>
							<h1 class="orange" id="NO_JBBC"></h1>
						</li>
						<li>
							<p>当班值长</p>
							<h1 class="green" id="NO_DBBZ"></h1>
						</li>
						<li>
							<p>接班值长</p>
							<h1 class="red" id="NO_JBBZ"></h1>
						</li>
					</ul>
				</div>
			</div>
			<div class="clearfix"></div>
			
			<div class="bottom" style="height:33%">
				<div class="cygn">
					<div class="title">
						<h1><i class="iconfont">&#xe638</i> 常用功能</h1>
						<!--<div class="more">
							<a href="###" >MORE>></a>
						</div>-->
					</div>
					<ul>
						<ylt.for dataId="1514365555773">
						<li>
							<a href="###"arg1="$value" arg2="$value" onclick="doViewMenuUrl('$value');"  >
								<p class="border-blue"><i class="iconfont">&#xe51d</i></p>
								<h1 id='$value'>$value </h1>
							</a>
						</li>
						</ylt.for>
						<li  onclick="md_modal_fun();">
							<a href="###">
								<p class="border-gray"><i class="iconfont">&#xe641</i></p>
								<h1>添加功能 </h1>
							</a>
						</li>
					</ul>
				</div>
				<div class="ygtj">
					<div class="title">
						<h1><i class="iconfont">&#xe638</i> 当月-工作票统计</h1>
						<!--<div class="more">
							<a href="###">MORE>></a>
						</div>-->
					</div>
					<div class="charts" style="width: 100%;height:75%;float: left; " id="barchartYgzptj">
						<!--<img src="new/images/charts2.png" class="center-block img-responsive">-->
						<script>
							var title = new Array();
							var kpsum = new Array();
							var jpsum = new Array();
							var indexNum = new Array();
							<ylt.for dataId="1547975078158">
								title.push('$value');
								kpsum.push('$value');
								jpsum.push('$value');
								indexNum.push('$value');
							</ylt.for>
							ygzptjfun(title,kpsum,jpsum,indexNum);
						<!--myfun();-->
						</script>
					</div>					
				</div>
			</div>
		</div>
	<!-- 待办事项 -->
	<div class="md-modal md-effect-1" id="todo" style="height:80%;width:900px;top:50%"></div>

<!---SISDATE--->
<script type="text/javascript">
	try {
		initTodoList();
		parent.initTodoList();
	} catch(err) {}
	
	try {
		window.setInterval(function() {
			initTodoList();
			}, 1000 * 60);
	} catch(err) {}

	var realTime = document.getElementById("realTime");
	var yfdlId1 = document.getElementById("id_yfdl1");
	var nfdlId1 = document.getElementById("id_nfdl1");
	
	var yfdlId2 = document.getElementById("id_yfdl2");
	var nfdlId2 = document.getElementById("id_nfdl2");
	var getSISDate = null;
	var locat = window.location.pathname;
	
	function getAjaxActive(){
		 var xmlHttp;
		 if (window.ActiveXObject) { 
		  xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
		 }
		 else if (window.XMLHttpRequest) { 
		  xmlHttp = new XMLHttpRequest();
		 }
		 return xmlHttp;
	}
	
	function getTx(param,aStrUrl){
		var xml=getAjaxActive();
		xml.open("POST",aStrUrl,false);
		xml.setRequestHeader("content-length",param.length);  
		xml.setRequestHeader("content-type","application/x-www-form-urlencoded");  
		xml.setRequestHeader("charset", "UTF-8");
		xml.send(param);  
		var res = xml.responseText;
		return res;
	}
	
	function subGetTx(_subStr,_vari){
	    var z = _subStr;
	    _vari ="var "+_vari+"='";
	    z=z.substring(z.indexOf(_vari)+_vari.length);
	    return z.substring(0,z.indexOf("';"));
	}
	if(locat.indexOf("/sip")==-1&&locat.indexOf("/hsdc")==-1){
	    getSisDateEvl();
	    getSISDate = setInterval(getSisDateEvl,10000);
	}
	function getSisDateEvl(){
		var sisData = getTx("disType=REALTIME","sis_date_ajax.v");
	    var sisDataDfdl = subGetTx(sisData,"eleSISData");
	    var sisDataYfdl = subGetTx(sisData,"eleSISDataYfdl");
	    var sisDataNfdl = subGetTx(sisData,"eleSISDataNfdl");
	    var sisDataYfdl1 = subGetTx(sisData,"eleSISDataYfdl1");
	    var sisDataNfdl1 = subGetTx(sisData,"eleSISDataNfdl1");
		var sisDataYfdl2 = subGetTx(sisData,"eleSISDataYfdl2");
	    var sisDataNfdl2 = subGetTx(sisData,"eleSISDataNfdl2");
	    try {
		    realTime.innerHTML= parseFloat(sisDataDfdl).toFixed(2);
	    } catch(err) {}
	    
	    try {
		    yfdlId1.innerHTML= parseFloat(sisDataYfdl1/10).toFixed(2);
	    } catch(err) {}
	    try {
		    yfdlId2.innerHTML= parseFloat(sisDataYfdl2/10).toFixed(2);
	    } catch(err) {}
	    try {
		    nfdlId1.innerHTML= parseFloat(sisDataNfdl1/10).toFixed(2);
	    } catch(err) {}
		try {
		    nfdlId2.innerHTML= parseFloat(sisDataNfdl2/10).toFixed(2);
	    } catch(err) {}
	}
	function sp(id) {
	    var arr = id.split("&");

	    if(arr[arr.length-1]=="6S"){
	        parent.miniWin('单据', '', 'View?SPAGECODE='+arr[1]+'&sys_bed=true&S_ID='+arr[2]+'&bmid='+arr[3], 2000, 1800, '', '');
	    }else{
	       parent.miniWin('审核', '', 'flow-box.v?home=home&bmid=' + arr[3] + '&s_id=' + arr[2] + '&sys_flow_run_id=' + arr[5] + '&s_flow_id=' + arr[4] + '&flow_ver=' + arr[6] + '&node_code=' + arr[8] + '&spagecode=' + arr[1] +'&s_aud_user=' + arr[7], 2000, 1800, '', '');
	    }
	}
	
	function initTodoList() {
		var todoList = getTx("","todoList.v");
	    document.getElementById('todo').innerHTML = todoList.substring(todoList.indexOf('{todoListStart}')+15, todoList.indexOf('{todoListEnd}'));
	    
	    var shortTodoList = getTx("","shortTodoList.v");
	    document.getElementById('short_todo_list').innerHTML = shortTodoList.substring(shortTodoList.indexOf('{todoListStart}')+15, shortTodoList.indexOf('{todoListEnd}'));
	}
</script>
<script type="text/javascript">
    var mainTopHeight=document.body.clientHeight-180-15;
    var boxSizing=mainTopHeight-60;
    document.getElementById('main-top').style.height=mainTopHeight+"px";
    document.getElementById('dbsx-table').style.height=boxSizing+"px";
    document.getElementById('gstp-img').style.height=boxSizing+"px";
    var dbsxNum = Math.floor(boxSizing/37);
    var dbsxCent = getTx('getLimit='+(dbsxNum-1),'czp_fxyk.v');
    dbsxCent=dbsxCent.substring(dbsxCent.indexOf('!@#$%^&*()')+'!@#$%^&*()'.length);
    document.getElementById('dbsx-table-content').innerHTML=dbsxCent.substring(0,dbsxCent.indexOf(")(*&^%$#@!"));
</script>

<script>
    document.getElementById('parentc').style.height=(document.getElementById('todo').offsetHeight-1030)+"px";

	document.getElementById('md-modal-fun').onclick=function () {
        doViewMenuUrl('View?SPAGECODE=1509178831204')
    };
	
	function md_modal_fun(){
		doViewMenuUrl('View?SPAGECODE=1509178831204')
	}
	
    function modal_todo_show(){
        document.getElementById('todo').setAttribute("class", "md-modal md-effect-1 md-show");
        document.getElementById('todo').style.visibility = "visible";
    };
    
    
    document.getElementById('md-todo-close').click = function () {
        document.getElementById('todo').setAttribute("class", "md-modal md-effect-1");
        document.getElementById('todo').style.visibility = "hidden";

    };
    
    document.getElementById('md-todo-close').addEventListener("click", function () {
        document.getElementById('todo').setAttribute("class", "md-modal md-effect-1");
        document.getElementById('todo').style.visibility = "hidden";

    });
       
    function mdTodoClose(){
        document.getElementById('todo').setAttribute("class", "md-modal md-effect-1");
        document.getElementById('todo').style.visibility = "hidden";
    }
    function doViewMenuUrl(_strUrl){parent.document.getElementById("framehome").src=_strUrl;parent.document.getElementById("secmenuitemcontainer").style.display="none";}
	
	function modal_todo_show_hy(){
        document.getElementById('todohy').setAttribute("class", "md-modal md-effect-1 md-show");
        document.getElementById('todohy').style.visibility = "visible";
    };
	function mdTodohyClose(){
        document.getElementById('todohy').setAttribute("class", "md-modal md-effect-1");
        document.getElementById('todohy').style.visibility = "hidden";
    }
	function hy(sId,bmid){
		 parent.miniWin('单据', '', 'View?SPAGECODE=1500468062382&sys_bed=true&S_ID='+sId+'&bmid='+bmid, 2000, 1800, '', '');
	}
	
	function morehy(){
		 parent.miniWin('单据', '', 'View?SPAGECODE=1500468079598&bmid=001017', 2000, 1800, '', '');
	}
	
<ylt.for dataId="1508987064870">/*值长*/
    var ZZYXRZ="$value`$value`$value`$value`";
    </script>
	<script type='text/javascript' src='rzzdlb.v?sys_ver=true&S_LBID=$value&ZJCODE=&type=ZZRZ&bmid=001017&SPAGECODE_v2=1500451139566&tableNameToSelect=T_ZZYXRZ&tableCol=S_JBZC'></script>
</ylt.for>

<script>
if(usiParam.length>0){
    var current = usiParam[0];
    var next = usiParam[1];
    document.getElementById("NO_DBBC").innerHTML=current._dutyTeamName; 
    document.getElementById("NO_DBBZ").innerHTML=current._dutyPerName;				
	document.getElementById("NO_JBBC").innerHTML=next._dutyTeamName;
	document.getElementById("NO_JBBZ").innerHTML=next._dutyPerName;
}
window.onload = function(){
	var screenHeight = window.screen.height;
	var screenWidth = window.screen.width;
	if(screenHeight <= 768 && screenWidth <= 1366){
		document.getElementById('dbsxh2').style.fontSize ="17px";
		document.getElementById('ybslh2').style.fontSize ="17px";
		document.getElementById('jhfdh2').style.fontSize ="17px";
		document.getElementById('sjfdh2').style.fontSize ="17px";
		document.getElementById('aqsch2').style.fontSize ="17px";
		var len = document.getElementById('hyxxul').getElementsByTagName('li').length;
		for(var i = 0;i < len;i++){
			document.getElementById('hyxxul').getElementsByTagName('li')[i].getElementsByTagName("a")[0].style.textIndent="0";
		}
	}
}
</script>
</body>
</html>
